<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7Sploit - Executor Concept</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script> 
    <style id="theme-variables">
        :root {
            --bg-primary: #F8F8F8;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #FDFDFD;
            --bg-header: #F6F6F6;
            --bg-interactive: #EAEAEA;
            --bg-interactive-hover: #DDDDDD;
            --bg-overlay: rgba(0,0,0,0.4);

            --text-primary: #333333;
            --text-secondary: #777777;
            --text-on-accent: #FFFFFF;
            --text-placeholder: #BBBBBB;

            --border-primary: #E0E0E0;
            --border-secondary: #CCCCCC;
            --border-interactive: #4A90E2;

            --accent-primary: #4A90E2;
            --accent-secondary: #357ABD;
            --accent-primary-t1: rgba(74, 144, 226, 0.1);
            --accent-primary-t2: rgba(74, 144, 226, 0.2);
            --accent-primary-t3: rgba(74, 144, 226, 0.3);
            --accent-primary-t4: rgba(74, 144, 226, 0.4);

            --scrollbar-track-bg: #FDFDFD;
            --scrollbar-thumb-bg: #4A90E2;
            --scrollbar-thumb-hover-bg: #357ABD;

            --success-color: #4CAF50;
            --error-color: #F44336;

            --editor-background: #FFFFFF;
            --editor-foreground: #333333;
            --editor-line-highlight: #F8F8F8;
            --editor-selection-bg: #4A90E230;
            --editor-widget-bg: #FDFDFD;
            --editor-widget-border: #E0E0E0;
        }
    </style>
    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--scrollbar-track-bg);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb-bg);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover-bg);
        }

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-primary); 
    margin: 0; 
    overflow: hidden; 
}

.app-container {
    width: 100vw; 
    height: 100vh; 
    background-color: var(--bg-secondary); 
    display: flex;
    flex-direction: column;
    overflow: hidden; 
    transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
}

        .top-bar {
            background-color: var(--bg-header); 
            padding: 0.6rem 1rem; 
            display: flex;
            align-items: center;
            justify-content: space-between; 
            border-bottom: 1px solid var(--border-primary); 
            flex-shrink: 0; 
        }
        
        .top-bar-left-content { 
            display: flex;
            align-items: center;
            gap: 0.75rem; 
        }

        .window-controls {
            display: flex;
            align-items: center;
            gap: 0.6rem; 
        }

        .window-control-btn {
            width: 20px; 
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-secondary); 
            cursor: pointer;
            border-radius: 4px; 
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        .window-control-btn:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--text-primary);
        }
        .window-control-btn svg {
            width: 12px; 
            height: 12px;
            stroke-width: 1.5; 
        }


        .app-title { 
            font-size: 1.25rem; 
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
        }
        .app-title svg { 
            width: 24px; 
            height: 24px; 
            margin-right: 0.5rem;
            color: var(--accent-primary);
        }

        .top-bar-actions { 
            display: flex;
            align-items: center;
            gap: 0.5rem; 
        }

        .top-bar-icon {
            color: var(--text-secondary); 
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .top-bar-icon:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--accent-primary); 
            transform: scale(1.1);
        }
        .top-bar-icon i { 
            /* Tailwind classes on <i> tag handle size */
        }


        .execute-button {
            background-color: var(--accent-primary);
            color: var(--text-on-accent);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px var(--accent-primary-t2);
            margin: 0 0.5rem; 
            min-width: 130px; 
            justify-content: center; 
        }
        .execute-button:hover {
            background-color: var(--accent-secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--accent-primary-t3);
        }
        .execute-button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 4px var(--accent-primary-t2);
        }
        .execute-button svg { /* For the spinner, if it's an SVG */
            width: 18px;
            height: 18px;
        }
        .execute-button .spinner { 
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


        .main-layout {
            display: flex;
            flex-grow: 1; 
            overflow: hidden; 
        }

        .sidebar {
            width: 250px;
            background-color: var(--bg-tertiary); 
            padding: 1rem;
            border-right: 1px solid var(--border-primary); 
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease-in-out, padding 0.3s ease-in-out, opacity 0.3s ease-in-out;
            color: var(--text-secondary);
            flex-shrink: 0; 
            overflow-y: auto; 
        }
        .sidebar.collapsed {
            width: 60px; 
            padding: 1rem 0.5rem;
        }
        .sidebar.collapsed .sidebar-title-text, 
        .sidebar.collapsed .script-item-text,
        .sidebar.collapsed .add-script-button span,
        .sidebar.collapsed .sidebar-toggle-button .script-item-text 
         {
            display: none; 
        }
        .sidebar.collapsed .script-item svg, .sidebar.collapsed .script-item i {
            margin-right: 0;
        }
        .sidebar.collapsed .sidebar-toggle-button {
            justify-content: center;
        }
        .sidebar.collapsed .add-script-button {
            justify-content: center; 
        }


        .sidebar-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .add-script-button {
            color: var(--text-secondary);
            padding: 0.3rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: flex; 
            align-items: center;
        }
        .add-script-button svg, .add-script-button i {
            width: 18px;
            height: 18px;
        }
        .add-script-button:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--accent-primary); 
        }


        .script-list {
            list-style: none;
            padding: 0;
            margin: 0;
            margin-top: 0.5rem; 
            flex-grow: 1;
        }
        .script-item {
            display: flex;
            align-items: center;
            padding: 0.6rem 0.5rem;
            border-radius: 6px;
            margin-bottom: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            font-size: 0.875rem;
            position: relative; 
        }
        .script-item:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--text-primary);
        }
        .script-item.active {
            background-color: var(--accent-primary);
            color: var(--text-on-accent);
            font-weight: 500;
        }
        .script-item.active svg, .script-item.active i {
            color: var(--text-on-accent) !important; 
        }
        .script-item svg, .script-item i {
            width: 18px;
            height: 18px;
            margin-right: 0.75rem;
            color: var(--text-placeholder); 
            transition: color 0.2s ease-in-out;
            flex-shrink: 0; 
        }
        .script-item:hover svg, .script-item:hover i {
            color: var(--accent-primary);
        }
        .script-item-text { 
            flex-grow: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .script-item-input {
            background-color: var(--bg-interactive-hover);
            color: var(--text-primary);
            border: 1px solid var(--border-interactive);
            border-radius: 3px;
            padding: 0.1rem 0.25rem;
            font-size: 0.875rem;
            outline: none;
            width: calc(100% - 22px); 
        }


        .sidebar-toggle-button {
            margin-top: auto; 
            background: none;
            border: 1px solid var(--border-secondary);
            color: var(--text-secondary);
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: flex-start; 
            transition: all 0.2s ease-in-out;
        }
        .sidebar-toggle-button:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }
        .sidebar-toggle-button svg, .sidebar-toggle-button i {
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease-in-out;
        }
        .sidebar.collapsed .sidebar-toggle-button svg, .sidebar.collapsed .sidebar-toggle-button i {
            transform: rotate(180deg); 
        }

        .context-menu {
            position: absolute;
            background-color: var(--bg-interactive); 
            border: 1px solid var(--border-secondary);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            padding: 0.5rem 0;
            z-index: 1000; 
            display: none; 
            min-width: 150px;
        }
        .context-menu-item {
            padding: 0.5rem 1rem;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .context-menu-item:hover {
            background-color: var(--accent-primary);
            color: var(--text-on-accent);
        }
        .context-menu-item svg, .context-menu-item i {
            width: 16px;
            height: 16px;
        }


        .content-area {
            flex-grow: 1; 
            display: flex;
            flex-direction: column;
            background-color: var(--bg-secondary); 
            overflow: hidden; 
        }

        #editor-tabs {
            display: flex;
            align-items: center; 
            background-color: var(--bg-tertiary); 
            padding: 0.25rem 0.5rem 0 0.5rem; 
            border-bottom: 1px solid var(--border-primary);
            flex-shrink: 0;
            overflow-x: auto; 
        }
        .tab-item {
            padding: 0.5rem 0.75rem; 
            cursor: pointer;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            margin-right: 0.25rem; 
            font-size: 0.875rem;
            transition: all 0.2s ease-in-out;
            white-space: nowrap; 
            display: flex;
            align-items: center;
            gap: 0.5rem; 
        }
        .tab-item:hover {
            color: var(--text-primary);
            border-bottom-color: var(--border-secondary);
        }
        .tab-item.active {
            color: var(--accent-primary);
            font-weight: 500;
            border-bottom-color: var(--accent-primary);
        }
        .tab-text { 
            flex-grow: 1;
            outline: none; 
        }
        .tab-text-input { 
            background-color: var(--bg-interactive-hover);
            color: var(--text-primary);
            border: 1px solid var(--border-interactive);
            border-radius: 3px;
            padding: 0.1rem 0.25rem;
            font-size: 0.875rem;
            outline: none;
            width: 100px; 
        }

        .tab-close-icon {
            font-family: 'Inter', sans-serif; 
            font-size: 1rem; 
            font-weight: normal;
            color: var(--text-placeholder);
            padding: 0 0.25rem; 
            border-radius: 3px; 
            line-height: 1; 
        }
        .tab-close-icon:hover {
            background-color: var(--bg-interactive-hover); 
            color: var(--text-on-accent); 
        }
        .add-tab-button {
            color: var(--text-secondary);
            padding: 0.4rem 0.6rem; 
            margin-left: 0.25rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.25rem; 
            line-height: 1;
            transition: all 0.2s ease-in-out;
        }
        .add-tab-button:hover {
            background-color: var(--bg-interactive-hover);
            color: var(--accent-primary);
        }


        #editor-container {
            flex-grow: 1; 
            width: 100%;
            height: 100%; 
        }

        .status-bar {
            background-color: var(--bg-header); 
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-primary); 
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; 
        }
        .status-bar-item {
            padding: 0 0.5rem;
        }
        .status-bar-item.clickable:hover {
            color: var(--accent-primary);
            cursor: pointer;
        }

        .pulsing {
            animation: pulse 1.5s infinite ease-in-out;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 var(--accent-primary-t4); }
            70% { box-shadow: 0 0 0 10px rgba(0,0,0,0); } 
            100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); }
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-overlay);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: var(--bg-interactive);
            padding: 1.5rem; 
            border-radius: 8px;
            color: var(--text-primary);
            min-width: 400px; 
            max-width: 90vw; /* Ensures responsiveness */
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform: scale(0.95);
            transition: transform 0.3s ease;
            /* Adding overflow-y for potentially tall content in settings */
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .theme-button {
            background-color: var(--bg-interactive-hover);
            color: var(--text-primary);
            border: 1px solid var(--border-secondary);
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s, border-color 0.2s;
            text-align: left; 
            width: calc(50% - 0.5rem); 
            box-sizing: border-box;
        }
        .theme-button:hover {
            background-color: var(--accent-primary);
            color: var(--text-on-accent);
            border-color: var(--accent-primary);
        }
        .theme-button.active-theme {
            background-color: var(--accent-secondary); 
            color: var(--text-on-accent);
            border-color: var(--accent-secondary);
            font-weight: bold;
        }
        .settings-section-title {
            font-size: 1rem; 
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            padding-bottom: 0.25rem;
            border-bottom: 1px solid var(--border-primary);
        }

    </style>
</head>
<body>

    <div class="app-container">
        <header class="top-bar">
            <div class="top-bar-left-content">
                <div class="app-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0021 18V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v12a2.25 2.25 0 002.25 2.25z" />
                    </svg>
                    7Sploit
                </div>
            </div>
            <div class="top-bar-actions">
                <div class="top-bar-icon" title="Open File" id="openFileButton">
                    <i data-lucide="file" class="w-5 h-5"></i>
                </div>
                <div class="top-bar-icon" title="Check for updates" id="checkUpdatesButton">
                    <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                </div>
                <div class="top-bar-icon" title="Clear Editor" id="clearEditorButton">
                    <i data-lucide="trash-2" class="w-5 h-5"></i>
                </div>
                <div class="top-bar-icon" title="Save to File" id="saveFileButton">
                    <i data-lucide="download" class="w-5 h-5"></i>
                </div>
                <button class="execute-button" id="executeButton" title="Execute Script"></button> 
                <div class="top-bar-icon" title="Settings" id="settingsButton">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                </div>
            </div>
        </header>

        <div class="main-layout">
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-title">
                    <span class="sidebar-title-text">Script Explorer</span>
                    <button class="add-script-button" id="addScriptExplorerButton" title="Add New Script">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
                        <span class="ml-1 text-xs">Add</span></button>
                </div>
                <ul class="script-list" id="scriptList">
                    <li class="script-item active" data-script-id="default-mainscript">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>
                        <span class="script-item-text">MainScript.lua</span>
                    </li>
                </ul>
                <button class="sidebar-toggle-button" id="sidebarToggle" title="Toggle Sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg>
                    <span class="script-item-text ml-2">Collapse</span>
                </button>
            </aside>

            <div class="content-area">
                <div id="editor-tabs">
                    <div class="add-tab-button" id="addTabButton" title="New Tab">+</div>
                    </div>
                <div id="editor-container"></div>
                <div class="status-bar">
                    <div class="status-bar-item" id="editorLineCol">Ln 1, Col 1</div>
                    <div class="status-bar-item">Spaces: 4</div>
                    <div class="status-bar-item">UTF-8</div>
                    <div class="status-bar-item clickable" id="executorStatus">Idle</div>
                    <div class="status-bar-item">Lua</div>
                </div>
            </div>
        </div>
    </div>

    <div id="scriptContextMenu" class="context-menu">
        <div class="context-menu-item" data-action="rename"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg>Rename</div>
        <div class="context-menu-item" data-action="delete"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.342.052.682.107 1.022.166m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg>Delete</div>
    </div>

    <div class="modal-overlay" id="settingsModalOverlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4"> <h2 class="text-xl font-semibold">Settings</h2>
                <button id="closeModalButton" class="text-2xl text-gray-400 hover:text-gray-200">&times;</button>
            </div>
            
            <div class="settings-section-title">Appearance</div>
            <div id="themeSelectorContainer" class="flex flex-wrap -mx-1 mt-2">
                </div>

            </div>
    </div>

    <input type="file" id="fileOpener" accept=".txt,.lua" style="display: none;">

    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs/loader.js"></script>
    <script>
        let editor; 
        let untitledTabCounter = 0; 
        const tabData = new Map(); 
        let scriptExplorerCounter = 1; 
        let activeScriptExplorerItem = null; 
        let executionTimeout = null; 
        let executorStatusElement; // Reference to the executor status element

        const themes = {
            "7sploit-dark": { 
                name: "7Sploit Dark (Default)",
                cssVariables: {
                    '--bg-primary': '#101010', '--bg-secondary': '#1A1A1A', '--bg-tertiary': '#202020',
                    '--bg-header': '#232323', '--bg-interactive': '#2c2c2c', '--bg-interactive-hover': '#333333',
                    '--text-primary': '#E0E0E0', '--text-secondary': '#A0A0A0', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#757575', '--border-primary': '#2c2c2c', '--border-secondary': '#444444',
                    '--border-interactive': '#00A9FF', '--accent-primary': '#00A9FF', '--accent-secondary': '#007acc',
                    '--scrollbar-track-bg': '#2c2c2c', '--scrollbar-thumb-bg': '#00A9FF', '--scrollbar-thumb-hover-bg': '#007acc',
                    '--editor-background': '#1E1E1E', '--editor-foreground': '#D4D4D4', '--editor-line-highlight': '#2A2A2A',
                    '--editor-selection-bg': '#00A9FF30', '--editor-widget-bg': '#252526', '--editor-widget-border': '#454545',
                    '--accent-primary-t1': 'rgba(0, 169, 255, 0.1)', '--accent-primary-t2': 'rgba(0, 169, 255, 0.2)',
                    '--accent-primary-t3': 'rgba(0, 169, 255, 0.3)', '--accent-primary-t4': 'rgba(0, 169, 255, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '6a9955' }, { token: 'keyword', foreground: '569cd6' },
                        { token: 'number', foreground: 'b5cea8' }, { token: 'string', foreground: 'ce9178' },
                        { token: 'identifier', foreground: 'dcdcaa' },
                    ],
                    colors: {
                        'editor.background': '#1E1E1E', 'editor.foreground': '#E0E0E0',
                        'editorCursor.foreground': '#00A9FF', 'editor.lineHighlightBackground': '#2A2A2A',
                        'editorLineNumber.foreground': '#6E6E6E', 'editorLineNumber.activeForeground': '#00A9FF',
                        'editorWhitespace.foreground': '#3B3A39', 'editorIndentGuide.background': '#3B3A39',
                        'editorIndentGuide.activeBackground': '#505050', 'editorHoverWidget.background': '#252526',
                        'editorHoverWidget.border': '#454545', 'editorSuggestWidget.background': '#252526',
                        'editorSuggestWidget.border': '#454545', 'editorSuggestWidget.selectedBackground': '#00A9FF30',
                        'minimap.background': '#202020', 'minimapSlider.background': '#00A9FF40',
                        'minimapSlider.hoverBackground': '#00A9FF60', 'minimapSlider.activeBackground': '#00A9FF80',
                    }
                }
            },
            "midnight-purple": { 
                name: "Midnight Purple",
                cssVariables: {
                    '--bg-primary': '#191724', '--bg-secondary': '#201e2d', '--bg-tertiary': '#2a273a',
                    '--bg-header': '#232130', '--bg-interactive': '#3e3a55', '--bg-interactive-hover': '#524c77',
                    '--text-primary': '#e0def4', '--text-secondary': '#908caa', '--text-on-accent': '#e0def4',
                    '--text-placeholder': '#6e6a86', '--border-primary': '#3e3a55', '--border-secondary': '#524c77',
                    '--border-interactive': '#c3a5f7', '--accent-primary': '#c3a5f7', '--accent-secondary': '#a987f0',
                    '--scrollbar-track-bg': '#2a273a', '--scrollbar-thumb-bg': '#c3a5f7', '--scrollbar-thumb-hover-bg': '#a987f0',
                    '--editor-background': '#201e2d', '--editor-foreground': '#e0def4', '--editor-line-highlight': '#2a273a',
                    '--editor-selection-bg': '#c3a5f730', '--editor-widget-bg': '#2a273a', '--editor-widget-border': '#524c77',
                    '--accent-primary-t1': 'rgba(195, 165, 247, 0.1)', '--accent-primary-t2': 'rgba(195, 165, 247, 0.2)',
                    '--accent-primary-t3': 'rgba(195, 165, 247, 0.3)', '--accent-primary-t4': 'rgba(195, 165, 247, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '6e6a86' }, { token: 'keyword', foreground: 'c3a5f7' },
                        { token: 'number', foreground: 'ebbcba' }, { token: 'string', foreground: 'f6c177' },
                        { token: 'identifier', foreground: 'e0def4' }, { token: 'type.identifier', foreground: '9ccfd8' },
                        { token: 'operator', foreground: 'c3a5f7' }, { token: 'delimiter', foreground: '908caa' }
                    ],
                    colors: {
                        'editor.background': '#201e2d', 'editor.foreground': '#e0def4',
                        'editorCursor.foreground': '#c3a5f7', 'editor.lineHighlightBackground': '#2a273a',
                        'editorLineNumber.foreground': '#6e6a86', 'editorLineNumber.activeForeground': '#c3a5f7',
                        'editorWhitespace.foreground': '#3e3a55', 'editorIndentGuide.background': '#3e3a55',
                        'editorIndentGuide.activeBackground': '#524c77', 'editorHoverWidget.background': '#2a273a',
                        'editorHoverWidget.border': '#524c77', 'editorSuggestWidget.background': '#2a273a',
                        'editorSuggestWidget.border': '#524c77', 'editorSuggestWidget.selectedBackground': '#c3a5f730',
                        'minimap.background': '#201e2d', 'minimapSlider.background': '#c3a5f740',
                        'minimapSlider.hoverBackground': '#c3a5f760', 'minimapSlider.activeBackground': '#c3a5f780',
                    }
                }
            },
            "deep-forest-green": { 
                name: "Deep Forest Green", 
                cssVariables: {
                    '--bg-primary': '#1A201C', '--bg-secondary': '#202A23', '--bg-tertiary': '#2A3A2F',
                    '--bg-header': '#253028', '--bg-interactive': '#3A5A40', '--bg-interactive-hover': '#4C7A53',
                    '--text-primary': '#D4E0D8', '--text-secondary': '#A0B0A8', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#708078', '--border-primary': '#3A5A40', '--border-secondary': '#4C7A53',
                    '--border-interactive': '#A3D9A5', '--accent-primary': '#A3D9A5', '--accent-secondary': '#82C085',
                    '--scrollbar-track-bg': '#2A3A2F', '--scrollbar-thumb-bg': '#A3D9A5', '--scrollbar-thumb-hover-bg': '#82C085',
                    '--editor-background': '#202A23', '--editor-foreground': '#D4E0D8', '--editor-line-highlight': '#2A3A2F',
                    '--editor-selection-bg': '#A3D9A530', '--editor-widget-bg': '#2A3A2F', '--editor-widget-border': '#4C7A53',
                    '--accent-primary-t1': 'rgba(163, 217, 165, 0.1)', '--accent-primary-t2': 'rgba(163, 217, 165, 0.2)',
                    '--accent-primary-t3': 'rgba(163, 217, 165, 0.3)', '--accent-primary-t4': 'rgba(163, 217, 165, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '708078' }, { token: 'keyword', foreground: 'A3D9A5' },
                        { token: 'number', foreground: 'F4B860' }, { token: 'string', foreground: 'D4E0D8' }, 
                        { token: 'identifier', foreground: 'E0EFE4' }, { token: 'type.identifier', foreground: '82C085' },
                         { token: 'operator', foreground: 'A3D9A5' }, { token: 'delimiter', foreground: 'A0B0A8' }
                    ],
                    colors: {
                        'editor.background': '#202A23', 'editor.foreground': '#D4E0D8',
                        'editorCursor.foreground': '#A3D9A5', 'editor.lineHighlightBackground': '#2A3A2F',
                        'editorLineNumber.foreground': '#708078', 'editorLineNumber.activeForeground': '#A3D9A5',
                        'editorWhitespace.foreground': '#3A5A40', 'editorIndentGuide.background': '#3A5A40',
                        'editorIndentGuide.activeBackground': '#4C7A53', 'editorHoverWidget.background': '#2A3A2F',
                        'editorHoverWidget.border': '#4C7A53', 'editorSuggestWidget.background': '#2A3A2F',
                        'editorSuggestWidget.border': '#4C7A53', 'editorSuggestWidget.selectedBackground': '#A3D9A530',
                        'minimap.background': '#202A23', 'minimapSlider.background': '#A3D9A540',
                        'minimapSlider.hoverBackground': '#A3D9A560', 'minimapSlider.activeBackground': '#A3D9A580',
                    }
                }
            },
            "classic-light": { 
                name: "Classic Light",
                cssVariables: {
                    '--bg-primary': '#F0F0F0', '--bg-secondary': '#FFFFFF', '--bg-tertiary': '#FAFAFA',
                    '--bg-header': '#F5F5F5', '--bg-interactive': '#E0E0E0', '--bg-interactive-hover': '#D6D6D6',
                    '--text-primary': '#212121', '--text-secondary': '#757575', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#BDBDBD', '--border-primary': '#E0E0E0', '--border-secondary': '#BDBDBD',
                    '--border-interactive': '#007ACC', '--accent-primary': '#007ACC', '--accent-secondary': '#005F9E',
                    '--scrollbar-track-bg': '#E0E0E0', '--scrollbar-thumb-bg': '#007ACC', '--scrollbar-thumb-hover-bg': '#005F9E',
                    '--editor-background': '#FFFFFF', '--editor-foreground': '#333333', '--editor-line-highlight': '#F0F0F0',
                    '--editor-selection-bg': '#007ACC30', '--editor-widget-bg': '#F3F3F3', '--editor-widget-border': '#C8C8C8',
                    '--accent-primary-t1': 'rgba(0, 122, 204, 0.1)', '--accent-primary-t2': 'rgba(0, 122, 204, 0.2)',
                    '--accent-primary-t3': 'rgba(0, 122, 204, 0.3)', '--accent-primary-t4': 'rgba(0, 122, 204, 0.4)',
                },
                monacoTheme: {
                    base: 'vs', inherit: true, 
                    rules: [
                        { token: 'comment', foreground: '008000' }, { token: 'keyword', foreground: '0000FF' },
                        { token: 'number', foreground: '098658' }, { token: 'string', foreground: 'A31515' },
                        { token: 'identifier', foreground: '000000' },
                    ],
                    colors: {
                        'editor.background': '#FFFFFF', 'editor.foreground': '#333333',
                        'editorCursor.foreground': '#000000', 'editor.lineHighlightBackground': '#F0F0F0',
                        'editorLineNumber.foreground': '#AAAAAA', 'editorLineNumber.activeForeground': '#000000',
                        'editorWhitespace.foreground': '#DDDDDD', 'editorIndentGuide.background': '#DDDDDD',
                        'editorIndentGuide.activeBackground': '#CCCCCC', 'editorHoverWidget.background': '#F3F3F3',
                        'editorHoverWidget.border': '#C8C8C8', 'editorSuggestWidget.background': '#F3F3F3',
                        'editorSuggestWidget.border': '#C8C8C8', 'editorSuggestWidget.selectedBackground': '#007ACC30',
                        'minimap.background': '#FAFAFA', 'minimapSlider.background': '#007ACC40',
                        'minimapSlider.hoverBackground': '#007ACC60', 'minimapSlider.activeBackground': '#007ACC80',
                    }
                }
            },
             "high-contrast-dark": { 
                name: "High Contrast Dark",
                cssVariables: {
                    '--bg-primary': '#000000', '--bg-secondary': '#0A0A0A', '--bg-tertiary': '#101010',
                    '--bg-header': '#0D0D0D', '--bg-interactive': '#1F1F1F', '--bg-interactive-hover': '#2D2D2D',
                    '--text-primary': '#FFFFFF', '--text-secondary': '#CCCCCC', '--text-on-accent': '#000000',
                    '--text-placeholder': '#888888', '--border-primary': '#333333', '--border-secondary': '#555555',
                    '--border-interactive': '#FFFF00', '--accent-primary': '#FFFF00', '--accent-secondary': '#DDDD00',
                    '--scrollbar-track-bg': '#1F1F1F', '--scrollbar-thumb-bg': '#FFFF00', '--scrollbar-thumb-hover-bg': '#DDDD00',
                    '--editor-background': '#000000', '--editor-foreground': '#FFFFFF', '--editor-line-highlight': '#1A1A1A',
                    '--editor-selection-bg': '#FFFF0040', '--editor-widget-bg': '#101010', '--editor-widget-border': '#555555',
                    '--accent-primary-t1': 'rgba(255, 255, 0, 0.1)', '--accent-primary-t2': 'rgba(255, 255, 0, 0.2)',
                    '--accent-primary-t3': 'rgba(255, 255, 0, 0.3)', '--accent-primary-t4': 'rgba(255, 255, 0, 0.4)',
                },
                monacoTheme: { 
                    base: 'hc-black', inherit: true,
                     rules: [
                        { token: 'comment', foreground: '80FF80' }, 
                        { token: 'keyword', foreground: 'FFFF00' }, 
                        { token: 'number', foreground: '00FFFF' }, 
                        { token: 'string', foreground: 'FF80FF' }, 
                        { token: 'identifier', foreground: 'FFFFFF' }, 
                        { token: 'type.identifier', foreground: '00FFFF' }, 
                        { token: 'operator', foreground: 'FFFF00' }, 
                        { token: 'delimiter', foreground: 'CCCCCC' }  
                    ],
                    colors: {
                        'editor.background': '#000000', 'editor.foreground': '#FFFFFF',
                        'editorCursor.foreground': '#FFFF00', 'editor.lineHighlightBackground': '#1A1A1A',
                        'editorLineNumber.foreground': '#CCCCCC', 'editorLineNumber.activeForeground': '#FFFF00',
                        'editorWhitespace.foreground': '#404040', 'editorIndentGuide.background': '#404040',
                        'editorIndentGuide.activeBackground': '#606060', 'editorHoverWidget.background': '#101010',
                        'editorHoverWidget.border': '#555555', 'editorSuggestWidget.background': '#101010',
                        'editorSuggestWidget.border': '#555555', 'editorSuggestWidget.selectedBackground': '#FFFF0040',
                        'minimap.background': '#0A0A0A', 'minimapSlider.background': '#FFFF0040',
                        'minimapSlider.hoverBackground': '#FFFF0060', 'minimapSlider.activeBackground': '#FFFF0080',
                    }
                }
            },
            "solarized-dark": {
                name: "Solarized Dark",
                cssVariables: {
                    '--bg-primary': '#002b36', '--bg-secondary': '#073642', '--bg-tertiary': '#001f27',
                    '--bg-header': '#08404f', '--bg-interactive': '#586e75', '--bg-interactive-hover': '#657b83',
                    '--text-primary': '#839496', '--text-secondary': '#586e75', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#586e75', '--border-primary': '#08404f', '--border-secondary': '#586e75',
                    '--border-interactive': '#268bd2', '--accent-primary': '#268bd2', '--accent-secondary': '#2aa198',
                    '--scrollbar-track-bg': '#001f27', '--scrollbar-thumb-bg': '#268bd2', '--scrollbar-thumb-hover-bg': '#2aa198',
                    '--editor-background': '#002b36', '--editor-foreground': '#839496', '--editor-line-highlight': '#073642',
                    '--editor-selection-bg': '#268bd240', '--editor-widget-bg': '#073642', '--editor-widget-border': '#586e75',
                    '--accent-primary-t1': 'rgba(38, 139, 210, 0.1)', '--accent-primary-t2': 'rgba(38, 139, 210, 0.2)',
                    '--accent-primary-t3': 'rgba(38, 139, 210, 0.3)', '--accent-primary-t4': 'rgba(38, 139, 210, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '586e75' }, { token: 'keyword', foreground: '859900' },
                        { token: 'number', foreground: '2aa198' }, { token: 'string', foreground: '2aa198' },
                        { token: 'identifier', foreground: '839496' },{ token: 'type.identifier', foreground: 'b58900' },
                        { token: 'operator', foreground: '6c71c4' }, { token: 'delimiter', foreground: '839496' }
                    ],
                    colors: {
                        'editor.background': '#002b36', 'editor.foreground': '#839496',
                        'editorCursor.foreground': '#839496', 'editor.lineHighlightBackground': '#073642',
                        'editorLineNumber.foreground': '#586e75', 'editorLineNumber.activeForeground': '#839496',
                        'editorWhitespace.foreground': '#073642', 'editorIndentGuide.background': '#073642',
                        'editorIndentGuide.activeBackground': '#586e75', 'editorSuggestWidget.selectedBackground': '#268bd240',
                    }
                }
            },
            "solarized-light": {
                name: "Solarized Light",
                cssVariables: {
                    '--bg-primary': '#fdf6e3', '--bg-secondary': '#eee8d5', '--bg-tertiary': '#f5f0e0',
                    '--bg-header': '#e8e2d0', '--bg-interactive': '#93a1a1', '--bg-interactive-hover': '#839496',
                    '--text-primary': '#657b83', '--text-secondary': '#93a1a1', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#93a1a1', '--border-primary': '#e8e2d0', '--border-secondary': '#93a1a1',
                    '--border-interactive': '#268bd2', '--accent-primary': '#268bd2', '--accent-secondary': '#2aa198',
                    '--scrollbar-track-bg': '#f5f0e0', '--scrollbar-thumb-bg': '#268bd2', '--scrollbar-thumb-hover-bg': '#2aa198',
                    '--editor-background': '#fdf6e3', '--editor-foreground': '#657b83', '--editor-line-highlight': '#eee8d5',
                    '--editor-selection-bg': '#268bd240', '--editor-widget-bg': '#eee8d5', '--editor-widget-border': '#93a1a1',
                    '--accent-primary-t1': 'rgba(38, 139, 210, 0.1)', '--accent-primary-t2': 'rgba(38, 139, 210, 0.2)',
                    '--accent-primary-t3': 'rgba(38, 139, 210, 0.3)', '--accent-primary-t4': 'rgba(38, 139, 210, 0.4)',
                },
                monacoTheme: {
                    base: 'vs', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '93a1a1' }, { token: 'keyword', foreground: '859900' },
                        { token: 'number', foreground: '2aa198' }, { token: 'string', foreground: '2aa198' },
                        { token: 'identifier', foreground: '657b83' },{ token: 'type.identifier', foreground: 'b58900' },
                        { token: 'operator', foreground: '6c71c4' }, { token: 'delimiter', foreground: '657b83' }
                    ],
                    colors: {
                        'editor.background': '#fdf6e3', 'editor.foreground': '#657b83',
                        'editorCursor.foreground': '#657b83', 'editor.lineHighlightBackground': '#eee8d5',
                        'editorLineNumber.foreground': '#93a1a1', 'editorLineNumber.activeForeground': '#657b83',
                        'editorWhitespace.foreground': '#eee8d5', 'editorIndentGuide.background': '#eee8d5',
                        'editorIndentGuide.activeBackground': '#93a1a1', 'editorSuggestWidget.selectedBackground': '#268bd240',
                    }
                }
            },
            "dracula": {
                name: "Dracula",
                cssVariables: {
                    '--bg-primary': '#282a36', '--bg-secondary': '#21222c', '--bg-tertiary': '#191a21',
                    '--bg-header': '#1f2029', '--bg-interactive': '#44475a', '--bg-interactive-hover': '#6272a4',
                    '--text-primary': '#f8f8f2', '--text-secondary': '#bd93f9', '--text-on-accent': '#f8f8f2',
                    '--text-placeholder': '#6272a4', '--border-primary': '#191a21', '--border-secondary': '#44475a',
                    '--border-interactive': '#bd93f9', '--accent-primary': '#bd93f9', '--accent-secondary': '#ff79c6',
                    '--scrollbar-track-bg': '#191a21', '--scrollbar-thumb-bg': '#bd93f9', '--scrollbar-thumb-hover-bg': '#ff79c6',
                    '--editor-background': '#282a36', '--editor-foreground': '#f8f8f2', '--editor-line-highlight': '#44475a40',
                    '--editor-selection-bg': '#44475a', '--editor-widget-bg': '#21222c', '--editor-widget-border': '#44475a',
                    '--accent-primary-t1': 'rgba(189, 147, 249, 0.1)', '--accent-primary-t2': 'rgba(189, 147, 249, 0.2)',
                    '--accent-primary-t3': 'rgba(189, 147, 249, 0.3)', '--accent-primary-t4': 'rgba(189, 147, 249, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '6272a4' }, { token: 'keyword', foreground: 'ff79c6' },
                        { token: 'number', foreground: 'bd93f9' }, { token: 'string', foreground: 'f1fa8c' },
                        { token: 'identifier', foreground: 'f8f8f2' }, { token: 'type.identifier', foreground: '8be9fd' },
                        { token: 'operator', foreground: 'ff79c6' }, { token: 'delimiter', foreground: 'f8f8f2' }
                    ],
                    colors: {
                        'editor.background': '#282a36', 'editor.foreground': '#f8f8f2',
                        'editorCursor.foreground': '#f8f8f2', 'editor.lineHighlightBackground': '#44475a40', 
                        'editorLineNumber.foreground': '#6272a4', 'editorLineNumber.activeForeground': '#f8f8f2',
                        'editor.selectionBackground': '#44475a', 'editorSuggestWidget.selectedBackground': '#44475a',
                    }
                }
            },
            "nord": {
                name: "Nord",
                cssVariables: {
                    '--bg-primary': '#2E3440', '--bg-secondary': '#3B4252', '--bg-tertiary': '#242933',
                    '--bg-header': '#353c4a', '--bg-interactive': '#4C566A', '--bg-interactive-hover': '#5E81AC',
                    '--text-primary': '#D8DEE9', '--text-secondary': '#E5E9F0', '--text-on-accent': '#ECEFF4',
                    '--text-placeholder': '#4C566A', '--border-primary': '#3B4252', '--border-secondary': '#4C566A',
                    '--border-interactive': '#88C0D0', '--accent-primary': '#88C0D0', '--accent-secondary': '#81A1C1',
                    '--scrollbar-track-bg': '#242933', '--scrollbar-thumb-bg': '#88C0D0', '--scrollbar-thumb-hover-bg': '#81A1C1',
                    '--editor-background': '#2E3440', '--editor-foreground': '#D8DEE9', '--editor-line-highlight': '#3B4252',
                    '--editor-selection-bg': '#434C5E', '--editor-widget-bg': '#3B4252', '--editor-widget-border': '#4C566A',
                    '--accent-primary-t1': 'rgba(136, 192, 208, 0.1)', '--accent-primary-t2': 'rgba(136, 192, 208, 0.2)',
                    '--accent-primary-t3': 'rgba(136, 192, 208, 0.3)', '--accent-primary-t4': 'rgba(136, 192, 208, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '4C566A' }, { token: 'keyword', foreground: '81A1C1' },
                        { token: 'number', foreground: 'B48EAD' }, { token: 'string', foreground: 'A3BE8C' },
                        { token: 'identifier', foreground: 'D8DEE9' }, { token: 'type.identifier', foreground: '8FBCBB' },
                        { token: 'operator', foreground: '81A1C1' }, { token: 'delimiter', foreground: 'ECEFF4' }
                    ],
                    colors: {
                        'editor.background': '#2E3440', 'editor.foreground': '#D8DEE9',
                        'editorCursor.foreground': '#D8DEE9', 'editor.lineHighlightBackground': '#3B4252',
                        'editorLineNumber.foreground': '#4C566A', 'editorLineNumber.activeForeground': '#D8DEE9',
                        'editor.selectionBackground': '#434C5E', 'editorSuggestWidget.selectedBackground': '#434C5E',
                    }
                }
            },
            "gruvbox-dark": {
                name: "Gruvbox Dark",
                cssVariables: {
                    '--bg-primary': '#282828', '--bg-secondary': '#1d2021', '--bg-tertiary': '#161819',
                    '--bg-header': '#202020', '--bg-interactive': '#504945', '--bg-interactive-hover': '#665c54',
                    '--text-primary': '#ebdbb2', '--text-secondary': '#bdae93', '--text-on-accent': '#282828',
                    '--text-placeholder': '#928374', '--border-primary': '#3c3836', '--border-secondary': '#504945',
                    '--border-interactive': '#fe8019', '--accent-primary': '#fe8019', '--accent-secondary': '#fabd2f',
                    '--scrollbar-track-bg': '#161819', '--scrollbar-thumb-bg': '#fe8019', '--scrollbar-thumb-hover-bg': '#fabd2f',
                    '--editor-background': '#282828', '--editor-foreground': '#ebdbb2', '--editor-line-highlight': '#3c3836',
                    '--editor-selection-bg': '#504945', '--editor-widget-bg': '#1d2021', '--editor-widget-border': '#504945',
                    '--accent-primary-t1': 'rgba(254, 128, 25, 0.1)', '--accent-primary-t2': 'rgba(254, 128, 25, 0.2)',
                    '--accent-primary-t3': 'rgba(254, 128, 25, 0.3)', '--accent-primary-t4': 'rgba(254, 128, 25, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '928374' }, { token: 'keyword', foreground: 'fb4934' }, 
                        { token: 'number', foreground: 'd3869b' }, 
                        { token: 'string', foreground: 'b8bb26' }, 
                        { token: 'identifier', foreground: 'ebdbb2' }, { token: 'type.identifier', foreground: 'fabd2f' }, 
                        { token: 'operator', foreground: 'fe8019' }, { token: 'delimiter', foreground: 'ebdbb2' } 
                    ],
                    colors: {
                        'editor.background': '#282828', 'editor.foreground': '#ebdbb2',
                        'editorCursor.foreground': '#ebdbb2', 'editor.lineHighlightBackground': '#32302f', 
                        'editorLineNumber.foreground': '#928374', 'editorLineNumber.activeForeground': '#ebdbb2',
                        'editor.selectionBackground': '#504945', 'editorSuggestWidget.selectedBackground': '#504945',
                    }
                }
            },
            "gruvbox-light": {
                name: "Gruvbox Light",
                cssVariables: {
                    '--bg-primary': '#fbf1c7', '--bg-secondary': '#ebdbb2', '--bg-tertiary': '#f2e5bc',
                    '--bg-header': '#e0d5b0', '--bg-interactive': '#bdae93', '--bg-interactive-hover': '#a89984',
                    '--text-primary': '#3c3836', '--text-secondary': '#504945', '--text-on-accent': '#fbf1c7',
                    '--text-placeholder': '#928374', '--border-primary': '#d5c4a1', '--border-secondary': '#bdae93',
                    '--border-interactive': '#d65d0e', '--accent-primary': '#d65d0e', '--accent-secondary': '#af3a03',
                    '--scrollbar-track-bg': '#f2e5bc', '--scrollbar-thumb-bg': '#d65d0e', '--scrollbar-thumb-hover-bg': '#af3a03',
                    '--editor-background': '#fbf1c7', '--editor-foreground': '#3c3836', '--editor-line-highlight': '#ebdbb2',
                    '--editor-selection-bg': '#d5c4a1', '--editor-widget-bg': '#ebdbb2', '--editor-widget-border': '#bdae93',
                    '--accent-primary-t1': 'rgba(214, 93, 14, 0.1)', '--accent-primary-t2': 'rgba(214, 93, 14, 0.2)',
                    '--accent-primary-t3': 'rgba(214, 93, 14, 0.3)', '--accent-primary-t4': 'rgba(214, 93, 14, 0.4)',
                },
                monacoTheme: {
                    base: 'vs', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '928374' }, { token: 'keyword', foreground: '9d0006' }, 
                        { token: 'number', foreground: '8f3f71' }, 
                        { token: 'string', foreground: '79740e' }, 
                        { token: 'identifier', foreground: '3c3836' }, { token: 'type.identifier', foreground: 'b57614' }, 
                        { token: 'operator', foreground: 'd65d0e' }, { token: 'delimiter', foreground: '3c3836' } 
                    ],
                    colors: {
                        'editor.background': '#fbf1c7', 'editor.foreground': '#3c3836',
                        'editorCursor.foreground': '#3c3836', 'editor.lineHighlightBackground': '#ebdbb2',
                        'editorLineNumber.foreground': '#928374', 'editorLineNumber.activeForeground': '#3c3836',
                        'editor.selectionBackground': '#d5c4a1', 'editorSuggestWidget.selectedBackground': '#d5c4a1',
                    }
                }
            },
            "monokai-classic": {
                name: "Monokai Classic",
                cssVariables: {
                    '--bg-primary': '#272822', '--bg-secondary': '#20211B', '--bg-tertiary': '#1A1B16',
                    '--bg-header': '#2F3129', '--bg-interactive': '#49483E', '--bg-interactive-hover': '#75715E',
                    '--text-primary': '#F8F8F2', '--text-secondary': '#A6E22E', '--text-on-accent': '#272822',
                    '--text-placeholder': '#75715E', '--border-primary': '#1A1B16', '--border-secondary': '#49483E',
                    '--border-interactive': '#FD971F', '--accent-primary': '#FD971F', '--accent-secondary': '#F92672', 
                    '--scrollbar-track-bg': '#1A1B16', '--scrollbar-thumb-bg': '#FD971F', '--scrollbar-thumb-hover-bg': '#F92672',
                    '--editor-background': '#272822', '--editor-foreground': '#F8F8F2', '--editor-line-highlight': '#3E3D32',
                    '--editor-selection-bg': '#49483E', '--editor-widget-bg': '#20211B', '--editor-widget-border': '#49483E',
                    '--accent-primary-t1': 'rgba(253, 151, 31, 0.1)', '--accent-primary-t2': 'rgba(253, 151, 31, 0.2)',
                    '--accent-primary-t3': 'rgba(253, 151, 31, 0.3)', '--accent-primary-t4': 'rgba(253, 151, 31, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '75715E' }, { token: 'keyword', foreground: 'F92672' }, 
                        { token: 'number', foreground: 'AE81FF' }, 
                        { token: 'string', foreground: 'E6DB74' }, 
                        { token: 'identifier', foreground: 'F8F8F2' }, { token: 'type.identifier', foreground: '66D9EF' }, 
                        { token: 'operator', foreground: 'F92672' }, { token: 'delimiter', foreground: 'F8F8F2' }
                    ],
                    colors: {
                        'editor.background': '#272822', 'editor.foreground': '#F8F8F2',
                        'editorCursor.foreground': '#F8F8F0', 'editor.lineHighlightBackground': '#3E3D32',
                        'editorLineNumber.foreground': '#75715E', 'editorLineNumber.activeForeground': '#F8F8F2',
                        'editor.selectionBackground': '#49483E', 'editorSuggestWidget.selectedBackground': '#49483E',
                    }
                }
            },
            "oceanic-next": {
                name: "Oceanic Next",
                cssVariables: {
                    '--bg-primary': '#1B2B34', '--bg-secondary': '#24343D', '--bg-tertiary': '#162026',
                    '--bg-header': '#202F38', '--bg-interactive': '#4F6773', '--bg-interactive-hover': '#65737E',
                    '--text-primary': '#CDD3DE', '--text-secondary': '#A7ADBA', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#4F6773', '--border-primary': '#162026', '--border-secondary': '#4F6773',
                    '--border-interactive': '#6699CC', '--accent-primary': '#6699CC', '--accent-secondary': '#5FB3B3',
                    '--scrollbar-track-bg': '#162026', '--scrollbar-thumb-bg': '#6699CC', '--scrollbar-thumb-hover-bg': '#5FB3B3',
                    '--editor-background': '#1B2B34', '--editor-foreground': '#CDD3DE', '--editor-line-highlight': '#24343D',
                    '--editor-selection-bg': '#4F677370', '--editor-widget-bg': '#24343D', '--editor-widget-border': '#4F6773',
                    '--accent-primary-t1': 'rgba(102, 153, 204, 0.1)', '--accent-primary-t2': 'rgba(102, 153, 204, 0.2)',
                    '--accent-primary-t3': 'rgba(102, 153, 204, 0.3)', '--accent-primary-t4': 'rgba(102, 153, 204, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '4F6773' }, { token: 'keyword', foreground: 'C594C5' }, 
                        { token: 'number', foreground: 'F99157' }, 
                        { token: 'string', foreground: '99C794' }, 
                        { token: 'identifier', foreground: 'CDD3DE' }, { token: 'type.identifier', foreground: 'FAC863' }, 
                        { token: 'operator', foreground: 'C594C5' }, { token: 'delimiter', foreground: 'CDD3DE' }
                    ],
                    colors: {
                        'editor.background': '#1B2B34', 'editor.foreground': '#CDD3DE',
                        'editorCursor.foreground': '#CDD3DE', 'editor.lineHighlightBackground': '#24343D',
                        'editorLineNumber.foreground': '#4F6773', 'editorLineNumber.activeForeground': '#CDD3DE',
                        'editor.selectionBackground': '#4F677370', 'editorSuggestWidget.selectedBackground': '#4F677370',
                    }
                }
            },
            "material-dark": {
                name: "Material Dark",
                cssVariables: {
                    '--bg-primary': '#263238', '--bg-secondary': '#1E272C', '--bg-tertiary': '#1A2327',
                    '--bg-header': '#222D32', '--bg-interactive': '#37474F', '--bg-interactive-hover': '#455A64',
                    '--text-primary': '#ECEFF1', '--text-secondary': '#B0BEC5', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#78909C', '--border-primary': '#1A2327', '--border-secondary': '#37474F',
                    '--border-interactive': '#82AAFF', '--accent-primary': '#82AAFF', '--accent-secondary': '#C3E88D',
                    '--scrollbar-track-bg': '#1A2327', '--scrollbar-thumb-bg': '#82AAFF', '--scrollbar-thumb-hover-bg': '#C3E88D',
                    '--editor-background': '#263238', '--editor-foreground': '#ECEFF1', '--editor-line-highlight': '#2E3C43',
                    '--editor-selection-bg': '#82AAFF40', '--editor-widget-bg': '#1E272C', '--editor-widget-border': '#37474F',
                    '--accent-primary-t1': 'rgba(130, 170, 255, 0.1)', '--accent-primary-t2': 'rgba(130, 170, 255, 0.2)',
                    '--accent-primary-t3': 'rgba(130, 170, 255, 0.3)', '--accent-primary-t4': 'rgba(130, 170, 255, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '546E7A' }, { token: 'keyword', foreground: 'C792EA' }, 
                        { token: 'number', foreground: 'F78C6C' }, 
                        { token: 'string', foreground: 'C3E88D' }, 
                        { token: 'identifier', foreground: 'EEFFFF' }, { token: 'type.identifier', foreground: 'FFCB6B' }, 
                        { token: 'operator', foreground: '89DDFF' }, { token: 'delimiter', foreground: 'EEFFFF' } 
                    ],
                    colors: {
                        'editor.background': '#263238', 'editor.foreground': '#ECEFF1',
                        'editorCursor.foreground': '#82AAFF', 'editor.lineHighlightBackground': '#2A3B43', 
                        'editorLineNumber.foreground': '#78909C', 'editorLineNumber.activeForeground': '#ECEFF1',
                        'editor.selectionBackground': '#82AAFF40', 'editorSuggestWidget.selectedBackground': '#82AAFF40',
                    }
                }
            },
            "material-light": {
                name: "Material Light",
                cssVariables: {
                    '--bg-primary': '#ECEFF1', '--bg-secondary': '#FFFFFF', '--bg-tertiary': '#FAFAFA',
                    '--bg-header': '#F5F5F5', '--bg-interactive': '#CFD8DC', '--bg-interactive-hover': '#B0BEC5',
                    '--text-primary': '#37474F', '--text-secondary': '#546E7A', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#90A4AE', '--border-primary': '#CFD8DC', '--border-secondary': '#B0BEC5',
                    '--border-interactive': '#0069C0', '--accent-primary': '#0069C0', '--accent-secondary': '#00897B', 
                    '--scrollbar-track-bg': '#FAFAFA', '--scrollbar-thumb-bg': '#0069C0', '--scrollbar-thumb-hover-bg': '#00897B',
                    '--editor-background': '#FFFFFF', '--editor-foreground': '#37474F', '--editor-line-highlight': '#ECEFF1',
                    '--editor-selection-bg': '#80CBC440', '--editor-widget-bg': '#FAFAFA', '--editor-widget-border': '#CFD8DC',
                    '--accent-primary-t1': 'rgba(0, 105, 192, 0.1)', '--accent-primary-t2': 'rgba(0, 105, 192, 0.2)',
                    '--accent-primary-t3': 'rgba(0, 105, 192, 0.3)', '--accent-primary-t4': 'rgba(0, 105, 192, 0.4)',
                },
                monacoTheme: {
                    base: 'vs', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '90A4AE' }, { token: 'keyword', foreground: '3949AB' }, 
                        { token: 'number', foreground: 'F57C00' }, 
                        { token: 'string', foreground: '00897B' }, 
                        { token: 'identifier', foreground: '#37474F' }, { token: 'type.identifier', foreground: 'D81B60' }, 
                        { token: 'operator', foreground: '3949AB' }, { token: 'delimiter', foreground: '#37474F' }
                    ],
                    colors: {
                        'editor.background': '#FFFFFF', 'editor.foreground': '#37474F',
                        'editorCursor.foreground': '#0069C0', 'editor.lineHighlightBackground': '#ECEFF1',
                        'editorLineNumber.foreground': '#B0BEC5', 'editorLineNumber.activeForeground': '#37474F',
                        'editor.selectionBackground': '#80CBC440', 'editorSuggestWidget.selectedBackground': '#80CBC440',
                    }
                }
            },
            "crimson-night": {
                name: "Crimson Night",
                cssVariables: {
                    '--bg-primary': '#1c1c1c', '--bg-secondary': '#262626', '--bg-tertiary': '#121212',
                    '--bg-header': '#222222', '--bg-interactive': '#4d0f0f', '--bg-interactive-hover': '#6b1212',
                    '--text-primary': '#e0d0d0', '--text-secondary': '#b0a0a0', '--text-on-accent': '#f5e5e5',
                    '--text-placeholder': '#807070', '--border-primary': '#333333', '--border-secondary': '#4d0f0f',
                    '--border-interactive': '#ff4d4d', '--accent-primary': '#ff4d4d', '--accent-secondary': '#e53935',
                    '--scrollbar-track-bg': '#121212', '--scrollbar-thumb-bg': '#ff4d4d', '--scrollbar-thumb-hover-bg': '#e53935',
                    '--editor-background': '#1c1c1c', '--editor-foreground': '#e0d0d0', '--editor-line-highlight': '#2f2f2f',
                    '--editor-selection-bg': '#ff4d4d30', '--editor-widget-bg': '#262626', '--editor-widget-border': '#4d0f0f',
                    '--accent-primary-t1': 'rgba(255, 77, 77, 0.1)', '--accent-primary-t2': 'rgba(255, 77, 77, 0.2)',
                    '--accent-primary-t3': 'rgba(255, 77, 77, 0.3)', '--accent-primary-t4': 'rgba(255, 77, 77, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '807070' }, { token: 'keyword', foreground: '#ff6666' },
                        { token: 'number', foreground: '#ffb3b3' }, { token: 'string', foreground: '#ff9999' },
                        { token: 'identifier', foreground: '#e0d0d0' }, { token: 'type.identifier', foreground: '#ff8080' },
                        { token: 'operator', foreground: '#ff4d4d' }, { token: 'delimiter', foreground: '#e0d0d0' }
                    ],
                    colors: {
                        'editor.background': '#1c1c1c', 'editor.foreground': '#e0d0d0',
                        'editorCursor.foreground': '#ff4d4d', 'editor.lineHighlightBackground': '#2f2f2f',
                        'editorLineNumber.foreground': '#807070', 'editorLineNumber.activeForeground': '#e0d0d0',
                        'editor.selectionBackground': '#ff4d4d30', 'editorSuggestWidget.selectedBackground': '#ff4d4d30',
                    }
                }
            },
            "emerald-forest": {
                name: "Emerald Forest",
                cssVariables: {
                    '--bg-primary': '#0D1B13', '--bg-secondary': '#12261A', '--bg-tertiary': '#0A140E',
                    '--bg-header': '#102016', '--bg-interactive': '#2A5C3A', '--bg-interactive-hover': '#3E8252',
                    '--text-primary': '#B0D4BE', '--text-secondary': '#87A991', '--text-on-accent': '#E6F5EB',
                    '--text-placeholder': '#6A8570', '--border-primary': '#1A3B25', '--border-secondary': '#2A5C3A',
                    '--border-interactive': '#50C878', '--accent-primary': '#50C878', '--accent-secondary': '#3CB371',
                    '--scrollbar-track-bg': '#0A140E', '--scrollbar-thumb-bg': '#50C878', '--scrollbar-thumb-hover-bg': '#3CB371',
                    '--editor-background': '#0D1B13', '--editor-foreground': '#B0D4BE', '--editor-line-highlight': '#12261A',
                    '--editor-selection-bg': '#50C87830', '--editor-widget-bg': '#12261A', '--editor-widget-border': '#2A5C3A',
                    '--accent-primary-t1': 'rgba(80, 200, 120, 0.1)', '--accent-primary-t2': 'rgba(80, 200, 120, 0.2)',
                    '--accent-primary-t3': 'rgba(80, 200, 120, 0.3)', '--accent-primary-t4': 'rgba(80, 200, 120, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '6A8570' }, { token: 'keyword', foreground: '#66D9A0' },
                        { token: 'number', foreground: '#98FB98' }, { token: 'string', foreground: '#A0E6B4' },
                        { token: 'identifier', foreground: '#B0D4BE' }, { token: 'type.identifier', foreground: '#77DD77' },
                        { token: 'operator', foreground: '#50C878' }, { token: 'delimiter', foreground: '#B0D4BE' }
                    ],
                    colors: {
                        'editor.background': '#0D1B13', 'editor.foreground': '#B0D4BE',
                        'editorCursor.foreground': '#50C878', 'editor.lineHighlightBackground': '#12261A',
                        'editorLineNumber.foreground': '#6A8570', 'editorLineNumber.activeForeground': '#B0D4BE',
                        'editor.selectionBackground': '#50C87830', 'editorSuggestWidget.selectedBackground': '#50C87830',
                    }
                }
            },
            "golden-sands": {
                name: "Golden Sands",
                cssVariables: {
                    '--bg-primary': '#3D2B1F', '--bg-secondary': '#4A362A', '--bg-tertiary': '#302217',
                    '--bg-header': '#423024', '--bg-interactive': '#7B5B3F', '--bg-interactive-hover': '#9C724E',
                    '--text-primary': '#F0E68C', '--text-secondary': '#D2B48C', '--text-on-accent': '#4A362A',
                    '--text-placeholder': '#A08C6E', '--border-primary': '#5C4033', '--border-secondary': '#7B5B3F',
                    '--border-interactive': '#FFD700', '--accent-primary': '#FFD700', '--accent-secondary': '#FFA500',
                    '--scrollbar-track-bg': '#302217', '--scrollbar-thumb-bg': '#FFD700', '--scrollbar-thumb-hover-bg': '#FFA500',
                    '--editor-background': '#3D2B1F', '--editor-foreground': '#F0E68C', '--editor-line-highlight': '#4A362A',
                    '--editor-selection-bg': '#FFD70030', '--editor-widget-bg': '#4A362A', '--editor-widget-border': '#7B5B3F',
                    '--accent-primary-t1': 'rgba(255, 215, 0, 0.1)', '--accent-primary-t2': 'rgba(255, 215, 0, 0.2)',
                    '--accent-primary-t3': 'rgba(255, 215, 0, 0.3)', '--accent-primary-t4': 'rgba(255, 215, 0, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: 'A08C6E' }, { token: 'keyword', foreground: '#FFBF00' }, 
                        { token: 'number', foreground: '#DAA520' }, 
                        { token: 'string', foreground: '#F4A460' }, 
                        { token: 'identifier', foreground: '#F0E68C' }, { token: 'type.identifier', foreground: '#FFC40C' }, 
                        { token: 'operator', foreground: '#FFD700' }, { token: 'delimiter', foreground: '#F0E68C' }
                    ],
                    colors: {
                        'editor.background': '#3D2B1F', 'editor.foreground': '#F0E68C',
                        'editorCursor.foreground': '#FFD700', 'editor.lineHighlightBackground': '#4A362A',
                        'editorLineNumber.foreground': '#A08C6E', 'editorLineNumber.activeForeground': '#F0E68C',
                        'editor.selectionBackground': '#FFD70030', 'editorSuggestWidget.selectedBackground': '#FFD70030',
                    }
                }
            },
            "cyberpunk-neon": {
                name: "Cyberpunk Neon",
                cssVariables: {
                    '--bg-primary': '#0d0221', '--bg-secondary': '#10032B', '--bg-tertiary': '#080116',
                    '--bg-header': '#0c021f', '--bg-interactive': '#240046', '--bg-interactive-hover': '#3c096c',
                    '--text-primary': '#f0f0f0', '--text-secondary': '#c77dff', '--text-on-accent': '#0d0221',
                    '--text-placeholder': '#5a189a', '--border-primary': '#240046', '--border-secondary': '#3c096c',
                    '--border-interactive': '#ff00e0', '--accent-primary': '#ff00e0', '--accent-secondary': '#00f5d4', 
                    '--scrollbar-track-bg': '#080116', '--scrollbar-thumb-bg': '#ff00e0', '--scrollbar-thumb-hover-bg': '#00f5d4',
                    '--editor-background': '#0d0221', '--editor-foreground': '#f0f0f0', '--editor-line-highlight': '#10032B',
                    '--editor-selection-bg': '#ff00e030', '--editor-widget-bg': '#10032B', '--editor-widget-border': '#3c096c',
                    '--accent-primary-t1': 'rgba(255, 0, 224, 0.1)', '--accent-primary-t2': 'rgba(255, 0, 224, 0.2)',
                    '--accent-primary-t3': 'rgba(255, 0, 224, 0.3)', '--accent-primary-t4': 'rgba(255, 0, 224, 0.4)',
                },
                monacoTheme: {
                    base: 'hc-black', inherit: true, 
                    rules: [
                        { token: 'comment', foreground: '5a189a' }, { token: 'keyword', foreground: '#ff00e0' }, 
                        { token: 'number', foreground: '#00f5d4' }, 
                        { token: 'string', foreground: '#fef08a' }, 
                        { token: 'identifier', foreground: '#f0f0f0' }, { token: 'type.identifier', foreground: '#70e000' }, 
                        { token: 'operator', foreground: '#ff00e0' }, { token: 'delimiter', foreground: '#f0f0f0' }
                    ],
                    colors: {
                        'editor.background': '#0d0221', 'editor.foreground': '#f0f0f0',
                        'editorCursor.foreground': '#ff00e0', 'editor.lineHighlightBackground': '#10032B',
                        'editorLineNumber.foreground': '#5a189a', 'editorLineNumber.activeForeground': '#f0f0f0',
                        'editor.selectionBackground': '#ff00e030', 'editorSuggestWidget.selectedBackground': '#ff00e030',
                    }
                }
            },
            "paper-white": {
                name: "Paper White",
                cssVariables: {
                    '--bg-primary': '#F8F8F8', '--bg-secondary': '#FFFFFF', '--bg-tertiary': '#FDFDFD',
                    '--bg-header': '#F6F6F6', '--bg-interactive': '#EAEAEA', '--bg-interactive-hover': '#DDDDDD',
                    '--text-primary': '#333333', '--text-secondary': '#777777', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#BBBBBB', '--border-primary': '#E0E0E0', '--border-secondary': '#CCCCCC',
                    '--border-interactive': '#4A90E2', '--accent-primary': '#4A90E2', '--accent-secondary': '#357ABD',
                    '--scrollbar-track-bg': '#FDFDFD', '--scrollbar-thumb-bg': '#4A90E2', '--scrollbar-thumb-hover-bg': '#357ABD',
                    '--editor-background': '#FFFFFF', '--editor-foreground': '#333333', '--editor-line-highlight': '#F8F8F8',
                    '--editor-selection-bg': '#4A90E230', '--editor-widget-bg': '#FDFDFD', '--editor-widget-border': '#E0E0E0',
                    '--accent-primary-t1': 'rgba(74, 144, 226, 0.1)', '--accent-primary-t2': 'rgba(74, 144, 226, 0.2)',
                    '--accent-primary-t3': 'rgba(74, 144, 226, 0.3)', '--accent-primary-t4': 'rgba(74, 144, 226, 0.4)',
                },
                monacoTheme: {
                    base: 'vs', inherit: true,
                    rules: [
                        { token: 'comment', foreground: 'AAAAAA' }, { token: 'keyword', foreground: '0077CC' },
                        { token: 'number', foreground: 'D2691E' }, 
                        { token: 'string', foreground: '228B22' }, 
                        { token: 'identifier', foreground: '333333' }, { token: 'type.identifier', foreground: 'C00000' }, 
                        { token: 'operator', foreground: '0077CC' }, { token: 'delimiter', foreground: '555555' }
                    ],
                    colors: {
                        'editor.background': '#FFFFFF', 'editor.foreground': '#333333',
                        'editorCursor.foreground': '#333333', 'editor.lineHighlightBackground': '#F8F8F8',
                        'editorLineNumber.foreground': '#BBBBBB', 'editorLineNumber.activeForeground': '#333333',
                        'editor.selectionBackground': '#4A90E230', 'editorSuggestWidget.selectedBackground': '#4A90E230',
                    }
                }
            },
            "charcoal-orange": {
                name: "Charcoal & Orange",
                cssVariables: {
                    '--bg-primary': '#36454F', '--bg-secondary': '#2C3A47', '--bg-tertiary': '#232F34',
                    '--bg-header': '#303D45', '--bg-interactive': '#4A5B64', '--bg-interactive-hover': '#5B6E7A',
                    '--text-primary': '#E0E7EA', '--text-secondary': '#B0BCC2', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#7D8C93', '--border-primary': '#4A5B64', '--border-secondary': '#5B6E7A',
                    '--border-interactive': '#FF8C00', '--accent-primary': '#FF8C00', '--accent-secondary': '#FFA500', 
                    '--scrollbar-track-bg': '#232F34', '--scrollbar-thumb-bg': '#FF8C00', '--scrollbar-thumb-hover-bg': '#FFA500',
                    '--editor-background': '#36454F', '--editor-foreground': '#E0E7EA', '--editor-line-highlight': '#2C3A47',
                    '--editor-selection-bg': '#FF8C0030', '--editor-widget-bg': '#2C3A47', '--editor-widget-border': '#4A5B64',
                    '--accent-primary-t1': 'rgba(255, 140, 0, 0.1)', '--accent-primary-t2': 'rgba(255, 140, 0, 0.2)',
                    '--accent-primary-t3': 'rgba(255, 140, 0, 0.3)', '--accent-primary-t4': 'rgba(255, 140, 0, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '7D8C93' }, { token: 'keyword', foreground: '#FFB347' }, 
                        { token: 'number', foreground: '#FFD180' }, 
                        { token: 'string', foreground: '#FFC04D' }, 
                        { token: 'identifier', foreground: '#E0E7EA' }, { token: 'type.identifier', foreground: '#FFA500' },
                        { token: 'operator', foreground: '#FF8C00' }, { token: 'delimiter', foreground: '#E0E7EA' }
                    ],
                    colors: {
                        'editor.background': '#36454F', 'editor.foreground': '#E0E7EA',
                        'editorCursor.foreground': '#FF8C00', 'editor.lineHighlightBackground': '#2C3A47',
                        'editorLineNumber.foreground': '#7D8C93', 'editorLineNumber.activeForeground': '#E0E7EA',
                        'editor.selectionBackground': '#FF8C0030', 'editorSuggestWidget.selectedBackground': '#FF8C0030',
                    }
                }
            },
            "slate-teal": {
                name: "Slate & Teal",
                cssVariables: {
                    '--bg-primary': '#2F4F4F', '--bg-secondary': '#3A5F5F', '--bg-tertiary': '#253F3F',
                    '--bg-header': '#355555', '--bg-interactive': '#527F7F', '--bg-interactive-hover': '#669999',
                    '--text-primary': '#D0E0E0', '--text-secondary': '#A0C0C0', '--text-on-accent': '#FFFFFF',
                    '--text-placeholder': '#709090', '--border-primary': '#406F6F', '--border-secondary': '#527F7F',
                    '--border-interactive': '#48D1CC', '--accent-primary': '#48D1CC', '--accent-secondary': '#20B2AA', 
                    '--scrollbar-track-bg': '#253F3F', '--scrollbar-thumb-bg': '#48D1CC', '--scrollbar-thumb-hover-bg': '#20B2AA',
                    '--editor-background': '#2F4F4F', '--editor-foreground': '#D0E0E0', '--editor-line-highlight': '#3A5F5F',
                    '--editor-selection-bg': '#48D1CC30', '--editor-widget-bg': '#3A5F5F', '--editor-widget-border': '#527F7F',
                    '--accent-primary-t1': 'rgba(72, 209, 204, 0.1)', '--accent-primary-t2': 'rgba(72, 209, 204, 0.2)',
                    '--accent-primary-t3': 'rgba(72, 209, 204, 0.3)', '--accent-primary-t4': 'rgba(72, 209, 204, 0.4)',
                },
                monacoTheme: {
                    base: 'vs-dark', inherit: true,
                    rules: [
                        { token: 'comment', foreground: '709090' }, { token: 'keyword', foreground: '#7FFFD4' }, 
                        { token: 'number', foreground: '#AFEEEE' }, 
                        { token: 'string', foreground: '#B0E0E6' }, 
                        { token: 'identifier', foreground: '#D0E0E0' }, { token: 'type.identifier', foreground: '#66CDAA' }, 
                        { token: 'operator', foreground: '#48D1CC' }, { token: 'delimiter', foreground: '#D0E0E0' }
                    ],
                    colors: {
                        'editor.background': '#2F4F4F', 'editor.foreground': '#D0E0E0',
                        'editorCursor.foreground': '#48D1CC', 'editor.lineHighlightBackground': '#3A5F5F',
                        'editorLineNumber.foreground': '#709090', 'editorLineNumber.activeForeground': '#D0E0E0',
                        'editor.selectionBackground': '#48D1CC30', 'editorSuggestWidget.selectedBackground': '#48D1CC30',
                    }
                }
            }

        };

        function applyTheme(themeKey) {
            const theme = themes[themeKey];
            if (!theme) {
                console.error("Theme not found:", themeKey);
                return;
            }

            const root = document.documentElement;
            for (const [key, value] of Object.entries(theme.cssVariables)) {
                root.style.setProperty(key, value);
            }

            if (editor && monaco) {
                const monacoThemeName = `monaco-${themeKey}`;
                monaco.editor.setTheme(monacoThemeName);
            }
            
            document.querySelectorAll('.theme-button').forEach(btn => {
                btn.classList.toggle('active-theme', btn.dataset.themeKey === themeKey);
            });

            localStorage.setItem('selectedTheme', themeKey);
        }

        require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs' }});
        require(['vs/editor/editor.main'], function() {
            for (const themeKey in themes) {
                if (themes.hasOwnProperty(themeKey)) {
                    const monacoThemeName = `monaco-${themeKey}`;
                    monaco.editor.defineTheme(monacoThemeName, themes[themeKey].monacoTheme);
                }
            }
            
            editor = monaco.editor.create(document.getElementById('editor-container'), {
                value: "-- Welcome to 7Sploit! ",
                language: 'lua',
                theme: 'vs-dark', // This will be overridden by applyTheme
                minimap: { enabled: true, side: 'right' },
                automaticLayout: true, 
                fontSize: 14,
                lineNumbers: 'on',
                roundedSelection: false,
                scrollBeyondLastLine: false,
                wordWrap: 'on',
                glyphMargin: true,
                folding: true,
                lineDecorationsWidth: 10,
                lineNumbersMinChars: 3,
            });

            editor.onDidChangeCursorPosition(e => {
                const position = e.position;
                document.querySelector('.status-bar-item:first-child').textContent = `Ln ${position.lineNumber}, Col ${position.column}`;
            });

            editor.onDidChangeModelContent(() => {
                const activeTab = document.querySelector('.tab-item.active');
                if (activeTab) {
                    tabData.set(activeTab.dataset.tabId, editor.getValue());
                }
            });
            
            const savedTheme = localStorage.getItem('selectedTheme') || 'paper-white'; // Default to paper-white or your preferred default
            applyTheme(savedTheme); 

            addNewTab("MainScript.lua", "-- Content for MainScript.lua\nprint('Hello from 7Sploit!')");
            setExecuteButtonState('idle'); 
        });

        const openFileButton = document.getElementById('openFileButton');
        const clearEditorButton = document.getElementById('clearEditorButton');
        const saveFileButton = document.getElementById('saveFileButton');
        const fileOpenerInput = document.getElementById('fileOpener');
        const executeButton = document.getElementById('executeButton');
        const executorStatus = document.getElementById('executorStatus');
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const toggleButtonText = sidebarToggle.querySelector('.script-item-text');
        const scriptList = document.getElementById('scriptList');
        const addScriptExplorerButton = document.getElementById('addScriptExplorerButton');
        const scriptContextMenu = document.getElementById('scriptContextMenu');
        const tabContainer = document.getElementById('editor-tabs');
        const addTabButton = document.getElementById('addTabButton');
        const settingsButton = document.getElementById('settingsButton');
        const settingsModalOverlay = document.getElementById('settingsModalOverlay');
        const closeModalButton = document.getElementById('closeModalButton');
        const themeSelectorContainer = document.getElementById('themeSelectorContainer');


        openFileButton.addEventListener('click', () => {
            // Send message to native Swift code to open file dialog
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.scriptHandler) {
                window.webkit.messageHandlers.scriptHandler.postMessage({ type: "openTextFile" });
                showNotification("Opening file dialog...", "success");
            } else {
                // Fallback for browser environment (if not running in WKWebView)
                fileOpenerInput.click(); // This will open the browser's file dialog
                showNotification("Using browser file dialog.", "info");
            }
        });
        // The fileOpenerInput change listener remains for the browser fallback
        fileOpenerInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const content = e.target.result;
                    addNewTab(file.name, content);
                };
                reader.readAsText(file);
                event.target.value = null; 
            }
        });

        clearEditorButton.addEventListener('click', () => {
            const activeTab = document.querySelector('.tab-item.active');
            if (activeTab && editor) {
                const tabId = activeTab.dataset.tabId;
                tabData.set(tabId, ""); 
                editor.setValue("");
                showNotification("Editor cleared!", "success");
            } else {
                showNotification("No active tab to clear!", "error");
            }
        });

        saveFileButton.addEventListener('click', () => {
            const activeTab = document.querySelector('.tab-item.active');
            if (activeTab && editor) {
                const content = editor.getValue();
                const tabTextElement = activeTab.querySelector('.tab-text');
                let filename = tabTextElement ? tabTextElement.textContent.replace(/[^a-z0-9_.-]/gi, '_') : "7sploit_script";
                // Ensure a .lua extension or similar if desired, or let native handle it
                if (!filename.endsWith('.lua') && !filename.endsWith('.txt')) {
                    filename += '.lua'; // Default to .lua if no extension
                }
                
                // Send save request to native app
                if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.scriptHandler) {
                    window.webkit.messageHandlers.scriptHandler.postMessage({
                        type: "saveScriptAsTextFile",
                        scriptContent: content,
                        suggestedFileName: filename
                    });
                    showNotification("Save request sent to native app!", "success");
                } else {
                    // Fallback to browser download if native bridge not available
                    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(link.href);
                    showNotification(`File saved: ${filename}`, "success");
                }
            } else {
                showNotification("No active tab to save!", "error");
            }
        });

        function setExecuteButtonState(state) {
            if (!executeButton || !executorStatus) return; 
            if (state === 'executing') {
                executeButton.classList.add('pulsing');
                executeButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="spinner h-5 w-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>Executing...`;
                executorStatus.textContent = 'Executing...';
                executorStatus.style.color = 'var(--accent-primary)';
            } else if (state === 'finished') {
                executeButton.classList.remove('pulsing');
                executeButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" /></svg>Execute`;
                executorStatus.textContent = 'Finished';
                executorStatus.style.color = 'var(--success-color)'; 
            } else { 
                executeButton.classList.remove('pulsing');
                executeButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" /></svg>Execute`;
                executorStatus.textContent = 'Idle';
                executorStatus.style.color = 'var(--text-secondary)';
            }
        }
        executeButton.addEventListener('click', () => {
            const currentScriptContent = editor.getValue();
            const activeTab = document.querySelector('.tab-item.active');
            const tabName = activeTab ? activeTab.querySelector('.tab-text').textContent : "Untitled Script";

            // Send script to native app for execution
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.scriptHandler) {
                window.webkit.messageHandlers.scriptHandler.postMessage({
                    type: "executeScript",
                    script: currentScriptContent,
                    tabName: tabName
                });
                showNotification(`Executing script: ${tabName}`, "success");
                setExecuteButtonState('executing');
                // Simulate execution completion (in real app, native would send back a message)
                executionTimeout = setTimeout(() => {
                    setExecuteButtonState('finished');
                    setTimeout(() => {
                        setExecuteButtonState('idle');
                        executionTimeout = null;
                    }, 2000);
                }, 3000);
            } else {
                showNotification("Native bridge not found. Cannot execute script.", "error");
                setExecuteButtonState('idle');
            }
        });

        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            const isCollapsed = sidebar.classList.contains('collapsed');
            if (toggleButtonText) { 
                toggleButtonText.textContent = isCollapsed ? 'Expand' : 'Collapse';
            }
            sidebarToggle.title = isCollapsed ? "Expand Sidebar" : "Collapse Sidebar";
            if (editor) editor.layout(); // Relayout editor after sidebar collapse/expand
        });

        function createScriptExplorerItem(id, name) {
            const listItem = document.createElement('li');
            listItem.classList.add('script-item');
            listItem.dataset.scriptId = id;

            const iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>`;
            const textSpan = document.createElement('span');
            textSpan.classList.add('script-item-text');
            textSpan.textContent = name;

            listItem.innerHTML = iconSvg; 
            listItem.appendChild(textSpan); 

            listItem.addEventListener('click', () => {
                document.querySelectorAll('#scriptList .script-item').forEach(i => i.classList.remove('active'));
                listItem.classList.add('active');
                const scriptName = textSpan.textContent;
                let existingTab = Array.from(tabContainer.querySelectorAll('.tab-item')).find(t => t.querySelector('.tab-text').textContent === scriptName);
                if (existingTab) {
                    activateTab(existingTab);
                } else {
                    addNewTab(scriptName, tabData.get(id) || `-- Script: ${scriptName}\n`); // Use content from tabData map
                }
            });

            textSpan.addEventListener('dblclick', () => makeScriptItemEditable(textSpan));
            listItem.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                activeScriptExplorerItem = listItem; 
                scriptContextMenu.style.top = `${e.clientY}px`;
                scriptContextMenu.style.left = `${e.clientX}px`;
                scriptContextMenu.style.display = 'block';
            });
            return listItem;
        }

        function makeScriptItemEditable(textSpanElement) {
            const oldName = textSpanElement.textContent;
            const input = document.createElement('input');
            input.type = 'text';
            input.value = oldName;
            input.classList.add('script-item-input');

            textSpanElement.textContent = ''; 
            textSpanElement.appendChild(input);
            input.focus();
            input.select();

            function saveName() {
                const newName = input.value.trim();
                textSpanElement.textContent = (newName && newName !== oldName) ? newName : oldName;
                if (input.parentElement === textSpanElement) { 
                    textSpanElement.removeChild(input);
                }
                // Update tab name if it exists
                const scriptId = textSpanElement.closest('.script-item').dataset.scriptId;
                const tabItem = Array.from(tabContainer.querySelectorAll('.tab-item')).find(t => t.querySelector('.tab-text').textContent === oldName);
                if (tabItem) {
                    tabItem.querySelector('.tab-text').textContent = textSpanElement.textContent;
                }

                input.removeEventListener('blur', saveName);
                input.removeEventListener('keydown', handleInputKey);
            }

            function handleInputKey(e) {
                if (e.key === 'Enter') saveName();
                else if (e.key === 'Escape') {
                    textSpanElement.textContent = oldName; 
                    if (input.parentElement === textSpanElement) textSpanElement.removeChild(input);
                    input.removeEventListener('blur', saveName); 
                    input.removeEventListener('keydown', handleInputKey);
                }
            }
            input.addEventListener('blur', saveName);
            input.addEventListener('keydown', handleInputKey);
        }

        addScriptExplorerButton.addEventListener('click', () => {
            const scriptId = `script-${Date.now()}-${scriptExplorerCounter}`;
            const scriptName = `New Script ${scriptExplorerCounter++}`;
            const newItem = createScriptExplorerItem(scriptId, scriptName);
            scriptList.appendChild(newItem);
            // Also create a new tab for it and activate
            addNewTab(scriptName, `-- Script: ${scriptName}\n`);
        });

        document.addEventListener('click', (e) => {
            if (scriptContextMenu.style.display === 'block' && !scriptContextMenu.contains(e.target) && !e.target.closest('.script-item')) {
                scriptContextMenu.style.display = 'none';
            }
        });

        scriptContextMenu.addEventListener('click', (e) => {
            const actionItem = e.target.closest('.context-menu-item');
            if (actionItem && activeScriptExplorerItem) {
                const action = actionItem.dataset.action;
                const scriptTextSpan = activeScriptExplorerItem.querySelector('.script-item-text');
                const scriptIdToDelete = activeScriptExplorerItem.dataset.scriptId;

                if (action === 'rename' && scriptTextSpan) {
                    makeScriptItemEditable(scriptTextSpan);
                } else if (action === 'delete') {
                    const wasActive = activeScriptExplorerItem.classList.contains('active');
                    const scriptNameToDelete = scriptTextSpan ? scriptTextSpan.textContent : null;
                    
                    activeScriptExplorerItem.remove();
                    activeScriptExplorerItem = null; 

                    if (scriptNameToDelete) {
                        const tabToDelete = Array.from(tabContainer.querySelectorAll('.tab-item')).find(t => t.querySelector('.tab-text').textContent === scriptNameToDelete);
                        if (tabToDelete) {
                             const closeIcon = tabToDelete.querySelector('.tab-close-icon');
                             if(closeIcon) closeIcon.click(); 
                        }
                    }
                    tabData.delete(scriptIdToDelete); // Remove from map

                    if(wasActive && scriptList.children.length > 0) {
                        const firstScriptItem = scriptList.children[0];
                        firstScriptItem.classList.add('active');
                        const newActiveScriptText = firstScriptItem.querySelector('.script-item-text');
                        if(newActiveScriptText) {
                             let existingTab = Array.from(tabContainer.querySelectorAll('.tab-item')).find(t => t.querySelector('.tab-text').textContent === newActiveScriptText.textContent);
                            if (existingTab) activateTab(existingTab);
                            else addNewTab(newActiveScriptText.textContent, tabData.get(firstScriptItem.dataset.scriptId) || `-- Script: ${newActiveScriptText.textContent}\n`);
                        }
                    } else if (scriptList.children.length === 0 && tabContainer.querySelectorAll('.tab-item').length === 0) {
                        addNewTab();
                    }
                }
            }
            scriptContextMenu.style.display = 'none'; 
        });


        function createTabElement(tabId, tabName, initialContent = "-- Welcome to 7Sploit! ") {
            const tabItem = document.createElement('div');
            tabItem.classList.add('tab-item');
            tabItem.dataset.tabId = tabId;

            const tabText = document.createElement('span');
            tabText.classList.add('tab-text');
            tabText.textContent = tabName;
            tabText.addEventListener('dblclick', (e) => {
                e.stopPropagation(); // Prevent tab activation on dblclick
                makeTabEditable(tabText, tabItem);
            }); 

            const closeIcon = document.createElement('span');
            closeIcon.classList.add('tab-close-icon');
            closeIcon.innerHTML = '&times;'; 

            tabItem.appendChild(tabText);
            tabItem.appendChild(closeIcon);

            tabData.set(tabId, initialContent); 
            return tabItem;
        }
        
        function makeTabEditable(tabTextElement, tabItemElement) {
            const oldName = tabTextElement.textContent;
            const input = document.createElement('input');
            input.type = 'text';
            input.value = oldName;
            input.classList.add('tab-text-input'); 

            tabTextElement.textContent = ''; 
            tabTextElement.appendChild(input);
            input.focus();
            input.select();

            function saveTabName() {
                const newName = input.value.trim();
                tabTextElement.textContent = (newName && newName !== oldName) ? newName : oldName;
                if (input.parentElement === tabTextElement) tabTextElement.removeChild(input);
                input.removeEventListener('blur', saveTabName);
                input.removeEventListener('keydown', handleInputKeydown);
                // Update script explorer item name if it exists and matches
                const scriptItem = Array.from(scriptList.querySelectorAll('.script-item')).find(item => item.querySelector('.script-item-text').textContent === oldName);
                if (scriptItem) {
                    scriptItem.querySelector('.script-item-text').textContent = tabTextElement.textContent;
                }
            }

            function handleInputKeydown(e) {
                if (e.key === 'Enter') saveTabName();
                else if (e.key === 'Escape') {
                    tabTextElement.textContent = oldName; 
                    if (input.parentElement === tabTextElement) tabTextElement.removeChild(input);
                    input.removeEventListener('blur', saveTabName); 
                    input.removeEventListener('keydown', handleInputKeydown);
                }
            }
            input.addEventListener('blur', saveTabName);
            input.addEventListener('keydown', handleInputKeydown);
        }


        function addNewTab(name, content) {
            untitledTabCounter++;
            const tabId = `tab-${Date.now()}-${untitledTabCounter}`; 
            const tabName = name || `Untitled Tab ${untitledTabCounter}`;
            const initialContent = content !== undefined ? content : "-- Welcome to 7Sploit! ";

            const newTabElement = createTabElement(tabId, tabName, initialContent);
            tabContainer.insertBefore(newTabElement, addTabButton); 
            activateTab(newTabElement);
            // Scroll to the new tab if it's not visible
            newTabElement.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });
        }

        function activateTab(tabElement) {
            if (!tabElement || !editor) return; 

            tabContainer.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
            tabElement.classList.add('active');

            const tabId = tabElement.dataset.tabId;
            editor.setValue(tabData.get(tabId) || ""); 
            editor.focus(); // Focus the editor when tab is activated
        }

        addTabButton.addEventListener('click', () => addNewTab());

        tabContainer.addEventListener('click', (event) => {
            const targetTab = event.target.closest('.tab-item');

            if (event.target.classList.contains('tab-close-icon')) {
                event.stopPropagation(); 
                const tabToClose = event.target.parentElement;
                const tabIdToClose = tabToClose.dataset.tabId;
                let tabToActivate = null;

                if (tabToClose.classList.contains('active')) {
                    tabToActivate = tabToClose.nextElementSibling !== addTabButton ? tabToClose.nextElementSibling : tabToClose.previousElementSibling;
                }

                tabData.delete(tabIdToClose); 
                tabToClose.remove(); 

                if (tabContainer.querySelectorAll('.tab-item').length === 0) {
                    addNewTab(); 
                } else if (tabToActivate && tabToActivate.classList.contains('tab-item')) {
                    activateTab(tabToActivate);
                } else if (!document.querySelector('.tab-item.active') && tabContainer.querySelectorAll('.tab-item').length > 0) {
                    activateTab(tabContainer.querySelector('.tab-item'));
                } else if (tabContainer.querySelectorAll('.tab-item').length === 0 && editor) {
                     editor.setValue("-- All tabs closed. Open or create a new tab. --"); 
                }
                return; 
            }

            if (targetTab && !targetTab.classList.contains('active')) {
                activateTab(targetTab);
            }
        });

        settingsButton.addEventListener('click', () => settingsModalOverlay.classList.add('visible'));
        closeModalButton.addEventListener('click', () => settingsModalOverlay.classList.remove('visible'));
        settingsModalOverlay.addEventListener('click', (event) => {
            if (event.target === settingsModalOverlay) { 
                settingsModalOverlay.classList.remove('visible');
            }
        });

        function populateThemeSelector() {
            themeSelectorContainer.innerHTML = ''; 
            for (const key in themes) {
                if (themes.hasOwnProperty(key)) {
                    const theme = themes[key];
                    const button = document.createElement('button');
                    button.classList.add('theme-button');
                    button.textContent = theme.name;
                    button.dataset.themeKey = key;
                    button.addEventListener('click', () => applyTheme(key));
                    themeSelectorContainer.appendChild(button);
                }
            }
        }
        populateThemeSelector();

        // Initial setup for the default MainScript.lua item
        const initialScriptItem = document.querySelector('#scriptList .script-item[data-script-id="default-mainscript"]');
        if(initialScriptItem) {
            const textSpan = initialScriptItem.querySelector('.script-item-text');
            if (textSpan) { 
                textSpan.addEventListener('dblclick', () => makeScriptItemEditable(textSpan));
            }
            initialScriptItem.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                activeScriptExplorerItem = initialScriptItem;
                scriptContextMenu.style.top = `${e.clientY}px`;
                scriptContextMenu.style.left = `${e.clientX}px`;
                scriptContextMenu.style.display = 'block';
            });
            initialScriptItem.addEventListener('click', () => {
                document.querySelectorAll('#scriptList .script-item').forEach(i => i.classList.remove('active'));
                initialScriptItem.classList.add('active');
                const scriptName = textSpan ? textSpan.textContent : "MainScript.lua"; 
                let existingTab = Array.from(tabContainer.querySelectorAll('.tab-item')).find(t => t.querySelector('.tab-text').textContent === scriptName);
                if (existingTab) {
                    activateTab(existingTab);
                } else {
                    // Use the content stored in tabData for 'default-mainscript'
                    addNewTab(scriptName, tabData.get("default-mainscript") || `-- Script: ${scriptName}\n`);
                }
            });
        }

        // --- Native Bridge Communication Functions (Global for Swift to call) ---

        // Function to update the executor status from native Swift code
        window.updateConnectionStatus = function(status, port) {
            if (executorStatusElement) {
                executorStatusElement.textContent = status;
                if (status === "Online") {
                    executorStatusElement.style.color = 'var(--success-color)';
                    executorStatusElement.classList.remove('pulsing'); // Remove pulsing if it was waiting
                } else if (status === "Waiting") {
                    executorStatusElement.style.color = 'var(--accent-primary)';
                    executorStatusElement.classList.add('pulsing');
                } else { // Offline, etc.
                    executorStatusElement.style.color = 'var(--error-color)';
                    executorStatusElement.classList.remove('pulsing');
                }
            }
            // You might also want to log this to a console if you add one to 7Sploit
            console.log(`Native Connection Status: ${status} on port ${port}`);
        };

        // Function to log messages from native Swift code to a JS console (if implemented)
        window.logToConsole = function(message) {
            // In 7SploitReal (7).html, there isn't a dedicated console output area.
            // For now, we'll just log to the browser console.
            // If you add a console div to 7Sploit, you'd append messages there.
            console.log(`[Native Log] ${message}`);
            // Example if you add a console div:
            // const consoleOutputDiv = document.getElementById('consoleOutput');
            // if (consoleOutputDiv) {
            //     const logEntry = document.createElement('div');
            //     logEntry.textContent = message;
            //     consoleOutputDiv.appendChild(logEntry);
            //     consoleOutputDiv.scrollTop = consoleOutputDiv.scrollHeight;
            // }
        };

        // Function to show notifications from native Swift code
        window.showNotification = function(message, type, duration = 3000) {
            // 7SploitReal (7).html does not have a header notification bar.
            // For now, we'll use a simple temporary div at the bottom of the screen.
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.left = '50%';
            notification.style.transform = 'translateX(-50%)';
            notification.style.backgroundColor = type === 'success' ? 'var(--success-color)' : 'var(--error-color)';
            notification.style.color = 'white';
            notification.style.padding = '10px 20px';
            notification.style.borderRadius = '5px';
            notification.style.zIndex = '2000';
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.3s ease-in-out';
            
            document.body.appendChild(notification);

            // Fade in
            setTimeout(() => { notification.style.opacity = '1'; }, 10);

            // Fade out and remove
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.addEventListener('transitionend', () => notification.remove());
            }, duration);
        };

        // NEW: Function to receive file content from native Swift code
        window.receiveFileContent = function(fileName, content) {
            if (editor) {
                // Create a new tab with the file content
                addNewTab(fileName, content);
                showNotification(`Opened file: ${fileName}`, "success");
            } else {
                showNotification(`Error: Editor not ready to open ${fileName}.`, "error");
            }
        };


        // Initial request for connection status from native app on load
        window.addEventListener('load', () => {
            executorStatusElement = document.getElementById('executorStatus'); // Get reference on load

            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.scriptHandler) {
                // Request current connection status from native app
                window.webkit.messageHandlers.scriptHandler.postMessage({ type: "requestConnectionAction" });
            } else {
                console.warn("Native bridge not available. Connection status will not be updated.");
                window.updateConnectionStatus("Offline", "N/A"); // Set initial status if no bridge
            }
        });

    </script>
    <script>
      lucide.createIcons();
    </script>
</body>
</html>
